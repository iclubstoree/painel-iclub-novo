
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Painel Administrativo</title>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>
<body>
  <h1>Upload de Planilha</h1>
  <input type="file" id="csvFile" accept=".csv">
  <button onclick="upload()">Enviar</button>
  <pre id="saida"></pre>
  <script>
    
const firebaseConfig = {
  apiKey: "AIzaSyD_FAKE_KEY",
  authDomain: "iclubstoree.firebaseapp.com",
  databaseURL: "https://iclubstoree-default-rtdb.firebaseio.com",
  projectId: "iclubstoree",
  storageBucket: "iclubstoree.appspot.com",
  messagingSenderId: "000000000000",
  appId: "1:000000000000:web:abc123"
};

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    function upload() {
      const fileInput = document.getElementById('csvFile');
      const file = fileInput.files[0];
      if (!file) return alert("Selecione a planilha!");

      const reader = new FileReader();
      reader.onload = function(event) {
        const linhas = event.target.result.split("\n").slice(1);
        const dadosPorLoja = {
          castanhal: [],
          belem: [],
          mix: [],
          atacado: []
        };
        linhas.forEach((linha) => {
          const colunas = linha.split(",");
          const loja = colunas[0]?.trim().toLowerCase();
          const produto = colunas[1]?.trim();
          const preco = parseFloat(colunas[2]?.trim().replace("R$", "").replace(",", "."));
          if (loja && preco > 0 && dadosPorLoja[loja]) {
            dadosPorLoja[loja].push({ Produto: produto, Preco: preco.toFixed(2) });
          }
        });

        for (const loja in dadosPorLoja) {
          db.ref(loja).set(dadosPorLoja[loja]);
        }

        document.getElementById("saida").innerText = "Upload e gravação no Firebase concluídos.";
      };
      reader.readAsText(file);
    }
  </script>
</body>
</html>
